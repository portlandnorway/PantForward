<div class="dashboard-container">
  <h1>Dashboard</h1>
  <div class="dashboard-user">
    <div class="profile-avatar">
      <% if current_user.avatar.attached? %>
        <p><%= cl_image_tag(current_user.avatar.key, class: "avatar-large", alt: "avatar-large", crop: :fill, gravity: :face) %></p>
      <% else %>
        <i class="fas fa-user-circle avatar-large"></i>
      <% end %>
    </div>

<!-- User Info -->
    <div class="current-user">
      <p>Name: <%= current_user.first_name%> <%= current_user.last_name %> </p>
      <p>Phone: <%= current_user.phone_number %></p>
      <p>Email: <%= current_user.email %></p>
    </div>
  </div>

  <!-- Note: I have used 3 different cards on this dashboard. I'm not attached to any. -->
  <!-- I have created a BookingCard, for the User that has Booked a collection to pick up, until it is confirmed -->
  <!-- I have created a DonatorCard, for the User that Donated, and I used to implement Edit/Destroy. This is redundant. -->
  <!-- I have also used your Card, for User's past/historical Collections. -->
  <!-- DonatorCard should likely be merged with your Card, and deleted. -->

<!-- Collections that the user has BOOKED, but not picked up. -->
  <div class="header-wrapper">
    <h3>Your pending collections</h3>
    <% if current_user.bookings.booked.any? %>
      <p>To be collected. Go get them now!</p>
    <% else %>
      <p> Nothing booked. Head to the map to get another!</p>
    <% end %>
  </div>
  <div class="container" id='booked'>
    <div class="row">
     <% current_user.bookings.each do |booking| %>
        <% if booking.status == 'booked' %>
          <%= render "shared/bookingCard", element: booking %>
        <% end %>
      <% end %>
    </div>
  </div>

<!-- Collections that the user has BOOKED & PICKED UP, but not are not confirmed by Donator. -->
  <div class="header-wrapper">
    <h3>Waiting for confirmation:</h3>
    <% if current_user.bookings.picked_up.any? %>
      <p>Great job! The donator has been notified, and will confirm soon.</p>
    <% else %>
      <p> Nothing picked up. Go grab some more!</p>
    <% end %>
  </div>
  <div class="row" id='picked_up'>
     <% current_user.bookings.each do |booking| %>
      <% if booking.picked_up? %>
        <%= render "shared/bookingCard", element: booking %>
      <% end %>
    <% end %>
  </div>

<!-- Collections the user has DONATED, and are active (not yet confirmed) -->
  <div class="header-wrapper">
    <h3>Your current donations:</h3>
  </div>
  <div class="container">
    <div class="row" id='donations'>
      <% current_user.collections.each do |donation| %>
        <% if donation.bookings.empty? || !donation.bookings.last.confirmed? %>
          <%= render "shared/card_donator", element: donation %>
        <% end %>
      <% end %>
    </div>
  </div>

<!-- User History. Any past bookings are here. I will implement stat logic today (lines 71 - 73) -->
  <div class="header-wrapper">
    <h3>History</h3>
    <p>You have made approximately: "X amount of kroner here" </p>
    <p>You have collected: "X amount of bottles here" </p>
    <p>You have have saved the mothereffing earth fact here" </p>
    <p>Confirmed:</p>
  </div>

<!-- User's past bookings Collected -->
  <div class="row" id='confirmed'>
    <% current_user.bookings.each do |booking| %>
      <% if booking.confirmed? %>
        <%= render "shared/bookingCard", element: booking %>
      <% end %>
    <% end %>

<!-- User's past collections Donated -->
    <% current_user.collections.each do |donation| %>
      <% if !donation.bookings.empty? && donation.bookings.last.confirmed? %>
        <%= render "shared/card", element: donation %>
      <% end %>
    <% end %>
  </div>

  <div class="button-container">
    <%= link_to "Sign Out", destroy_user_session_path, method: :delete, class:"button", style: "width: auto" %>
  </div>
</div>
